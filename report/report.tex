\documentclass[10pt,pdf,hyperref={unicode}]{beamer}
% Стандартные формульные пакеты
\usepackage{float,amsmath,esint,amsfonts,wrapfig,bbm}
\usepackage{multirow}
% Русский текст в формулах
\usepackage{mathtext}
% Подключение русского языка
\usepackage[T2A]{fontenc}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
% Рисунки
\usepackage{graphicx,caption,subcaption}
%Theme
\usetheme{Boadilla}
%\usecolortheme{dove}

\usepackage{ragged2e}

\setbeamertemplate{frametitle}[default][center]

\addtobeamertemplate{navigation symbols}{}{%
    \usebeamerfont{footline}%
    \usebeamercolor[fg]{footline}%
    \hspace{1em}%
    \large\insertframenumber/\inserttotalframenumber
}

\newcommand{\mytitle}[1]{\color{red}{\textbf{ #1 } }}
\newcommand{\myvec}[1]{\left| #1 \right\rangle}
\newcommand{\mymean}[3]{\left\langle #1 \left| #2 \right| #3 \right\rangle }
\newcommand{\myel}[2]{\langle #1 | #2 \rangle }
\newcommand{\myelr}[2]{\left\langle #1 \left| #2 \right.\right\rangle }
\newcommand{\myell}[2]{\left.\left\langle #1 \right| #2 \right\rangle }
\newcommand{\myexp}[1]{\text{exp}\left(#1\right)}

\begin{document}
\begin{frame}{\center\mytitle{\Large Time-dependent variational principles: \\ application for quantum dynamics}}
\begin{table}[]
\flushright
\begin{tabular}{r}
\large Student of 515 group\\
\large Paramonov Nikita\\
\end{tabular}
\end{table}
\vfill
\center
\today
\end{frame}

\begin{frame}{\mytitle{ How do we calculate quantum dynamics? } }

\begin{block}{Time-dependent Shr\"odinger equation:}
$$i\hbar\frac{\partial\Phi}{\partial t}=\hat{H}\Phi$$
Let's solve it formally:
$$\Phi(t) = \Phi(0)\myexp{-\frac{i}{\hbar}\hat{H}t}\Rightarrow\frac{\partial}{\partial t}\myel{\Phi(t)}{\Phi(t)}=0$$
We can use evolution operator to calculate dynamics of wave function --- \textbf{Split operator technique}.
\end{block}
\begin{columns}
\begin{column}{0.45\textwidth}
\begin{block}{Pros}
\begin{itemize}
\item accurate ($\Delta t^3$)
\end{itemize}
\end{block}
\end{column}

\begin{column}{0.45\textwidth}
\begin{block}{Cons}
\begin{itemize}
\item slow
\end{itemize}
\end{block}
\end{column}
\end{columns}

\center{\textbf{Is there any other way to estimate accurate quantum dynamics}?}

\end{frame}

\begin{frame}{\mytitle{ Time--dependent variational principleS(!) } }

\begin{block}{Time-dependent variational principle (TDVP):}
$$\delta S = \delta\left(\int_{0}^{t} W\,d\tilde{t}\right)=0,\ %
W = \frac{ \mymean{\Phi}  { \hat{H}-i\hbar\frac{\partial}{\partial t} }  %
			  { \Phi } }{ \myel{\Phi}{\Phi} }$$
\end{block}

\begin{block}{If $||W||<\infty$  $\forall t$ and $\delta S = 0\Rightarrow $ McLachlan's variational principle:}
$$\delta\left(\frac{ \mymean{\Phi} %
	 	{ \hat{H}-i\hbar\frac{\partial}{\partial t} }  %
		{ \Phi } }{ \myel{\Phi}{\Phi} } \right) = 0$$
\end{block}

\begin{block}{If $\delta W = 0$ and $\delta\myel{\Phi}{\Phi}=0\Rightarrow$ Dirac--Frenkel variational principle:}
$$\mymean{\delta\Phi} { \hat{H}-i\hbar\frac{\partial}{\partial t} } { \Phi } = 0$$
\end{block}
\end{frame}

\begin{frame}{\mytitle{Wave function ansatz}}
\begin{block}{Basis $\{\phi_k(\lambda_1,\ldots,\lambda_M)\}_{k=1}^N$: }
$$\myvec{\Psi}=\sum_{i=1}^N C_k\phi_k$$
$$\myvec{\delta\Psi}=\sum_{i=1}^N\left( \delta C_k \phi_k + C_k\sum_{l=1}^M\frac{\partial\phi_k}{\partial\lambda_{kl}}\delta\lambda_{kl} \right)$$
$$\delta C_m^*\sum_{k=1}^N\left\langle\phi_m\left|\hat{H}-i\hbar\frac{\partial}{\partial t}\right|C_k\phi_k\right\rangle=0$$
$$\delta\lambda_{mj}\sum_{k=1}^NC_m^*\left\langle\frac{\partial\phi_m}{\partial\lambda_{mj}}\left|\hat{H}-i\hbar\frac{\partial}{\partial t}\right|C_k\phi_k\right\rangle = 0$$
\end{block}
\end{frame}

\begin{frame}{\mytitle{Equation of motions}}
$$\dot{\vec{C}}_n = -\frac{i}{\hbar}\sum_{k,n=1}^N\mathbbm{S}^{-1}_{nm}\left(\mathbbm{H}_{mk}-i\hbar\boldsymbol{\tau}_{mk}\right)\vec{C}_k\text{ --- vector of coeficients}$$
$$\dot{\lambda}_{kl} = -\frac{i}{\hbar}\sum_{m=1}^N\sum_{j=1}^M\left(\mathbbm{X}^{-1}\right)_{km}^{lj}\mathbbm{Y}_m^j\text{ --- matrix of parameters}$$
$$\mathbbm{S}_{mk}=\myel{\phi_m}{\phi_k},\ \mathbbm{H}_{mk} = \mymean{\phi_m}{\hat{H}}{\phi_k},\ %
  \boldsymbol{\tau}_{mk} = \sum_{l=1}^M\myelr{\phi_m}{\frac{\partial\phi_k}{\partial\lambda_{kl}}}\dot{\lambda}_{kl}$$
$$\mathbbm{Y}_{m}^j=\sum_{n=1}^N\rho_{mn}\left(\mathbbm{H}_{mn}^{(j0)}-%
	                     (\mathbbm{S}^{(j0)}\mathbbm{S}^{-1}\mathbbm{H})_{mn} \right),\ %
  \mathbbm{X}_{km}^{lj}=\rho_{km}\left(\mathbbm{S}_{km}^{(lj)}-%
					     (\mathbbm{S}^{(l0)}\mathbbm{S}^{-1}\mathbbm{S}^{(0j)})_{km}\right)$$
$$\rho_{mn}=C_m^*C_n,\ \mathbbm{H}_{mn}^{(j0)}=\mymean{\frac{\partial\phi_m}{\partial\lambda_{mj}}}{\hat{H}}{\phi_n}$$
$$\mathbbm{S}_{mn}^{(j0)}=\myell{\frac{\partial\phi_m}{\partial\lambda_{mj}}}{\phi_n},\ %
  \mathbbm{S}_{km}^{(0j)}=\myelr{\phi_k}{\frac{\partial\phi_m}{\partial\lambda_{mj}}},\ %
  \mathbbm{S}_{km}^{(lj)}=\myelr{\frac{\partial\phi_k}{\partial\lambda_{kl}}}{\frac{\partial\phi_m}{\partial\lambda_{mj}}}$$
\end{frame}

\begin{frame}{\mytitle{What about laws of conservation?}}
\begin{block}{Conservation of norm:}
$$\frac{\partial}{\partial t}\myel{\Psi}{\Psi} = \sum_{k,m=1}^N\frac{\partial}{\partial t}\left( C_k^*C_m\myel{\phi_k}{\phi_m}\right) =%
  \frac{\partial}{\partial t}\vec{C}^{\dagger}\mathbbm{S}\vec{C} = \dot{\vec{C}}^{\dagger}\mathbbm{S}\vec{C} + %
								   \vec{C}^{\dagger}\mathbbm{S}\dot{\vec{C}} + %
								   \vec{C}^{\dagger}\dot{\mathbbm{S}}\vec{C}$$
\end{block}
\begin{block}{$\dot{\vec{C}} = -\frac{i}{\hbar}\mathbbm{S}^{-1}(\mathbbm{H}-i\hbar\boldsymbol{\tau})\vec{C}$}
$$\vec{C}^{\dagger}\mathbbm{S}\dot{\vec{C}} = -\frac{i}{\hbar}\vec{C}^{\dagger}(\mathbbm{H}-i\hbar\boldsymbol{\tau})\vec{C},$$
$$\dot{\vec{C}}^{\dagger}\mathbbm{S}\vec{C} = \left(-\frac{i}{\hbar}\mathbbm{S}^{-1}(\mathbbm{H}-i\hbar\boldsymbol{\tau})\vec{C}\right)^{\dagger}\mathbbm{S}\vec{C} = %
					    \frac{i}{\hbar}\vec{C}^{\dagger}(\mathbbm{H}+i\hbar\boldsymbol{\tau}^{\dagger})\vec{C}$$
$$\dot{\vec{C}}^{\dagger}\mathbbm{S}\vec{C} + \vec{C}^{\dagger}\mathbbm{S}\dot{\vec{C}} = %
					    - \vec{C}^{\dagger}(\boldsymbol{\tau}+\boldsymbol{\tau}^{\dagger})\vec{C} = -\vec{C}^{\dagger}\dot{\mathbbm{S}}\vec{C}\Rightarrow%
  \frac{\partial}{\partial t}\myel{\Psi}{\Psi} = 0$$
\end{block}
\end{frame}

\begin{frame}{\mytitle{What about laws of conservation?}}
\begin{block}{Conservation of energy:}
$$\frac{\partial}{\partial t}\frac{\mymean{\psi}{\hat{H}}{\psi}}{\myel{\Psi}{\Psi}} = %
  \frac{1}{\myel{\Psi}{\Psi}}\frac{\partial}{\partial t}\sum_{k,m=1}^NC_k^*C_m\mymean{\phi_k}{\hat{H}}{\phi_m} = $$
$$=\frac{1}{\myel{\Psi}{\Psi}}\frac{\partial}{\partial t}\vec{C}^{\dagger}\mathbbm{H}\vec{C}=%
  \frac{\dot{\vec{C}}^{\dagger}\mathbbm{H}\vec{C}+\vec{C}^{\dagger}\mathbbm{H}\dot{\vec{C}}}{\myel{\Psi}{\Psi}}$$
\end{block}
\begin{block}{$\dot{\vec{C}} = -\frac{i}{\hbar}\mathbbm{S}^{-1}(\mathbbm{H}-i\hbar\boldsymbol{\tau})\vec{C}$}
$$\vec{C}^{\dagger}\mathbbm{H}\dot{\vec{C}} = -\frac{i}{\hbar}\vec{C}^{\dagger}\mathbbm{H}\mathbbm{S}^{-1}(\mathbbm{H}-i\hbar\boldsymbol{\tau})\vec{C}$$
$$\dot{\vec{C}}^{\dagger}\mathbbm{H}\vec{C} = \frac{i}{\hbar}\vec{C}^\dagger(\mathbbm{H}+i\hbar\boldsymbol{\tau}^{\dagger})\mathbbm{S}^{-1}\mathbbm{H}\vec{C}$$
$$\vec{C}^{\dagger}\mathbbm{H}\dot{\vec{C}}+\dot{\vec{C}}^{\dagger}\mathbbm{H}\vec{C} = %
 -\vec{C}^{\dagger}(\mathbbm{H}\mathbbm{S}^{-1}\boldsymbol{\tau} + \boldsymbol{\tau}^{\dagger}\mathbbm{S}^{-1}\mathbbm{H})\vec{C}$$
\end{block}
\end{frame}

\begin{frame}{\mytitle{What about laws of conservation?}}
\begin{block}{Conservation of energy:}
$$(\mathbbm{H}\mathbbm{S}^{-1}\boldsymbol{\tau})_{mk}=\sum_{n,r=1}^N\mathbbm{H}_{mn}\mathbbm{S}^{-1}_{nr}\boldsymbol{\tau}_{rk}=$$
$$=\sum_{n,r=1}^N\mymean{\phi_m}{\hat{H}}{\phi_n}\mathbbm{S}^{-1}_{nr}\sum_{l=1}^M\myelr{\phi_r}{\frac{\partial\phi_k}{\partial\lambda_{kl}}}\dot{\lambda}_{kl}=$$
$$=\sum_{l=1}^M\mymean{\phi_m}{\hat{H}\left(\sum_{n,r=1}^N|\phi_n\rangle\mathbbm{S}^{-1}_{nr}\langle\phi_r|\right)}{\frac{\partial\phi_k}{\partial\lambda_{kl}}}\dot{\lambda}_{kl}=%
   \sum_{l=1}^M\dot{\lambda}_{kl}\left(\tilde{\mathbbm{H}}_{km}^{(l0)}\right)^*$$
$$(\mathbbm{H}\mathbbm{S}^{-1}\boldsymbol{\tau})_{mk}+(\mathbbm{H}\mathbbm{S}^{-1}\boldsymbol{\tau})_{mk}^{\dagger}=%
   2\mathit{Re}\left(\sum_{l=1}^M\dot{\lambda}_{kl}\left(\tilde{\mathbbm{H}}_{km}^{(l0)}\right)^*\right)\overset{{\color{red}{(?)}}}{=}0$$
\end{block}
\end{frame}

\begin{frame}{\mytitle{Basis set}}
\begin{block}{Frozen width gaussian wave packets:}
$$\myvec{g_k}=\myexp{\frac{1}{\hbar}\sum_{\alpha}\left[-\frac{1}{2}\omega r_{\alpha}^2 + \xi_{k\alpha}r_{\alpha} + \eta_{k\alpha} \right]}$$
$$\xi_{k\alpha}=\omega q_{k\alpha} + i\frac{p_{k\alpha}}{m_k},\ %
\eta_{k\alpha}=\frac{1}{4}\left( \ln\left[\frac{\omega}{\pi}\right] - 2\omega q_{k\alpha}^2\right) - i\frac{q_{k\alpha}p_{k\alpha}}{m_k}$$
$$\myvec{g_k}=\left(\frac{\omega}{\pi}\right)^{\alpha/4}%
	      \myexp{\frac{1}{\hbar}\sum_{\alpha}\left[-\frac{1}{2}\omega(r_{\alpha}-q_{k\alpha})^2 + i\frac{p_{k\alpha}}{m_k}(r_{\alpha}-q_{k\alpha}) \right]}$$
$$\frac{\mymean{g_k}{r_{\alpha}}{g_k}}{\myel{g_k}{g_k}} = q_{k\alpha},\ \frac{\mymean{g_k}{-i\hbar\frac{\partial}{\partial r_{\alpha}}}{g_k}}{\myel{g_k}{g_k}} = p_{k\alpha}$$
\end{block}
\textbf{Trick of gaussian wave packets}:\\
$$\dot{q}_{k\alpha} = \mathit{Re}(\dot{\xi}_{k\alpha})/\omega,\ \dot{p}_{k\alpha}=\mathit{Im}(\dot{\xi}_{k\alpha})\text{ --- we need only quarter of $\dot{\lambda}$ matrix}$$
\end{frame}

\begin{frame}{\mytitle{Initial conditions}}
\begin{block}{Nuclear eigenstates:}
$$\mathbbm{H}\vec{C}_k = E_k\mathbbm{S}\vec{C}_k$$
General eigenvalue problem --- several ways to solve it:
\begin{enumerate}
\item "symmetric"
\begin{itemize}
\item Lowdin orthogonalization
\item $\mathbbm{S}$--matrix decomposition
\end{itemize}
\item "nonsymmetric"
\end{enumerate}
\end{block}
\end{frame}

\begin{frame}{\mytitle{"Symmetric" methods}}
\begin{block}{Lowdin orthogonalization:}
$$\mathbbm{S} = \mathbbm{U}\mathbbm{S}_d\mathbbm{U}^{\dagger}\text{ --- $\mathbbm{S}_d$ is diagonal, $\mathbbm{U}$ is unitary}$$
$$\left(\mathbbm{S}_d^{-1/2}\mathbbm{U}^{\dagger}\mathbbm{H}\mathbbm{U}\mathbbm{S}_d^{-1/2}\right)%
   \left(\mathbbm{S}_d^{1/2}\mathbbm{U}^{\dagger}\vec{C}_k\right)=E_k\left(\mathbbm{S}_d^{1/2}\mathbbm{U}^{\dagger}\vec{C}_k\right)$$
$$\mathbbm{H}'\vec{C}_k'=E_k\vec{C}_k'$$
\end{block}
\begin{block}{$\mathbbm{S}$--matrix decomposition (Cholesky):}
$$\mathbbm{S}=\mathbbm{L}\mathbbm{L}^{\dagger}\text{ --- $\mathbbm{L}$ is lower triangular}$$
$$\left(\mathbbm{L}^{-1}\mathbbm{H}\left(\mathbbm{L}^{\dagger}\right)^{-1}\right)\left(\mathbbm{L}^{\dagger}\vec{C}_k\right) = E_k\left(\mathbbm{L}^{\dagger}\vec{C}_k\right)$$
$$\mathbbm{H}''\vec{C}_k''=E_k\vec{C}_k''$$
\end{block}
\end{frame}

\begin{frame}{\mytitle{"Nonsymmetric" method}}
\begin{block}{$\mathbbm{S}$--matrix inversion}
$$\mathbbm{S} = \mathbbm{U}\mathbbm{s}\mathbbm{V}^{\dagger}\text{ --- singular value decomposition}$$
$\mathbbm{s}$ --- diagonal matrix of singular values (eigenvalues of $\mathbbm{S}\mathbbm{S}^{\dagger}$ and $\mathbbm{S}^{\dagger}\mathbbm{S}$), \\
$\mathbbm{U}$ --- unitary matrix of left--singular vectors (eigenvectors of $\mathbbm{S}\mathbbm{S}^{\dagger}$), \\
$\mathbbm{V}$ --- unitary matrix of right--singular vectors (eigenvectors of $\mathbbm{S}^{\dagger}\mathbbm{S}$).
$$\mathbbm{S}^{-1} = \mathbbm{V}\mathbbm{s}^{-1}\mathbbm{U}^{\dagger}$$
\end{block}
\begin{block}{Types of singular values decompositions:}
\begin{enumerate}
\item Full SVD --- consider all singular values
\item Truncated SVD --- consider all singular values greater then $\varepsilon$,
			all other assume equal to zero
\item Regularized SVD --- consider all singular values with certain weights: $s_i'=w_is_i$
$$w_i = (s_i^2+\varepsilon^2)/s_i^2\text{ or } w_i = 1 + \varepsilon\cdot\myexp{-\varepsilon s_i}/s_i,\text{ where } \varepsilon\text{ is small}$$
\end{enumerate}
\end{block}
\end{frame}

\end{document}
